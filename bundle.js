!function(){var e=/^<([a-z]+)/i,t={option:[1,'<select multiple="multiple">',"</select>"],optgroup:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]},n=function(n,o){return(w=t[(n.match(e)||[])[1]])&&{html:w[1]+n+w[2],depth:w[0]}},o={},r=/^\s*<(!doctype|html)/i,a="object"==typeof document,l=a?document:o.createDocument(),c=function(e){return e=e.replace(/(^[^<]*|[^>]*$)/,""),!a&&r.test(e)?o.createDocument(e):function(e,t){var o=n(e),r=t.createElement("div");r.innerHTML=o?o.html:e;for(var a=r.childNodes,l=0,c=a.length,i=0;l<c;l++)if(3==a[l].nodeType&&++i>1)return r;if(r=r.firstChild,o)for(;o.depth--;)r=r.firstChild;return r}(e,l)},i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],u=/^([A-G])([#b])?(-?[0-9]+)?$/;function d(e,t){if("string"==typeof e&&!(e=s(e)))return null;t=isNaN(t)?0:Number(t);var n=i.indexOf(e.name)+t,o=Math.floor(n/12);return n%12==0?n=0:n<0?n=12+n%12:n>=12&&(n%=12),f(n,e.octave+o)}function s(e){var t=e.match(u);if(!t)return null;var n=t[1],o=t[2]||"",r=Number(t[3]||0);if("b"===o&&"F"!==n&&"C"!==n)return d(s(n+r),-1);var a=i.indexOf(n+o);return~a?f(a,r):null}function f(e,t){return{name:i[e],octave:t,freq:440*Math.pow(2,(e+12*t-57)/12),toString:function(){return this.name+this.octave}}}var p={notes:i,scale:function(e,t){var n=s(e),o=0;return[n].concat(t.map(function(e){return d(n,o+=e)}))}},m=Array.prototype.slice,b=c(['<div class="fretboard">','<div class="content">','<div class="fret">','<div class="note">','<span class="name"></span>','<sub class="octave"></sub>',"</div>","</div>","</div>","</div>"].join("")),v={Major:[2,2,1,2,2,2],"Minor (Natural)":[2,1,2,2,1,2],"Minor (Harmonic)":[2,1,2,2,1,3],"Minor (Melodic)":[2,1,2,2,2,2]},h=function(){var e=b.cloneNode(!0);e.content=e.querySelector(".content"),e.fret=e.querySelector(".fret"),e.note=e.querySelector(".note"),e.fret.parentNode.removeChild(e.fret);var t=m.call(arguments).reverse().map(N);return A(22).forEach(function(n){var o=e.fret.cloneNode();t.forEach(function(t){var r=e.note.cloneNode(!0),a=r.querySelector(".name"),l=r.querySelector(".octave");r.setAttribute("data-name",t[n].name),a.textContent=t[n].name,l.textContent=t[n].octave,o.appendChild(r)}),0===n?(o.classList.remove("fret"),o.classList.add("nut")):o.setAttribute("data-number",n),e.content.appendChild(o)}),e}("E2","A2","D3","G3","B3","E4"),y=c('<select><option value="">Select Tonic</option></select>'),C=c('<select><option value="">Select Scale</option></select>'),g=c('<span class="pitches">');function E(e,t){var n=t&&t.map(function(e){return e.name}),o=m.call(e.querySelectorAll(".note"));g.textContent=n.join(" "),o.forEach(function(e){!t||~n.indexOf(e.getAttribute("data-name"))?e.classList.remove("dimmed"):e.classList.add("dimmed")})}function N(e){return p.scale(e,A(21,1))}function A(e,t){return Array(e).join(".").split(".").map(function(e,n){return void 0===t?n:t})}p.notes.forEach(function(e){var t=document.createElement("option");t.textContent=e,y.appendChild(t)}),Object.keys(v).forEach(function(e){var t=document.createElement("option");t.textContent=e,t.value=v[e].join("-"),C.appendChild(t)}),y.onchange=C.onchange=function(){var e=y.value,t=C.value;if(!e||!t)return E(h);t=C.value.split("-").map(Number),E(h,p.scale(e,t))},document.body.appendChild(y),document.body.appendChild(C),document.body.appendChild(g),document.body.appendChild(h)}();